const express = require('express');
const bodyParser = require('body-parser');
const path = require('path');

const app = express();
const PORT = 3000;

// Middlewares
app.use(bodyParser.urlencoded({ extended: true }));
app.use(bodyParser.json());
app.set('view engine', 'ejs');
app.use(express.static(path.join(__dirname, 'public')));

// In-memory chat store
let chatHistory = [];

// Serve UI
app.get('/', (req, res) => {
  res.render('chat', { messages: chatHistory });
});

// Handle chat POST request
app.post('/chat', (req, res) => {
  const userMessage = req.body.message;
  chatHistory.push({ sender: 'user', content: userMessage });

  // Mock AI response
  const aiReply = AI Bot: You said "${userMessage}";
  chatHistory.push({ sender: 'bot', content: aiReply });

  res.redirect('/');
});

// Start server
app.listen(PORT, () => console.log(ðŸš€ Chat app running at http://localhost:${PORT}));
